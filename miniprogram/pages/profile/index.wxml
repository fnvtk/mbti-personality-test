<!--pages/profile/index.wxml - 我的页面（匹配5-19-ai H5）-->
<view class="container">
  <!-- 顶部标题 -->
  <view class="header">
    <text class="header-title">我的</text>
  </view>

  <!-- 用户信息卡片 -->
  <view class="user-card" wx:if="{{hasLogin}}">
    <image class="avatar" src="{{userInfo.avatarUrl || '/images/default-avatar.png'}}" mode="aspectFill"></image>
    <view class="user-info">
      <text class="nickname">{{userInfo.nickName || '用户'}}</text>
      <view class="balance-tag" wx:if="{{balance > 0}}">
        <text class="balance-text">¥{{balance}}</text>
      </view>
    </view>
    <view class="user-actions">
      <view class="action-btn" bindtap="goToSettings">
        <text>编辑</text>
      </view>
    </view>
  </view>

  <!-- 未登录状态 -->
  <view class="user-card login-card" wx:else>
    <view class="login-avatar">👤</view>
    <view class="user-info">
      <text class="nickname">未登录</text>
      <text class="login-tip">登录后可查看测试记录</text>
    </view>
    <view class="login-btn" bindtap="doLogin">
      <text>登录</text>
    </view>
  </view>

  <!-- 功能入口 -->
  <view class="menu-section">
    <view class="menu-item" bindtap="goToHistory">
      <view class="menu-icon">📋</view>
      <view class="menu-content">
        <text class="menu-label">测试历史</text>
        <text class="menu-desc">{{testCount}}条记录</text>
      </view>
      <text class="menu-arrow">›</text>
    </view>

    <view class="menu-item" bindtap="goToPurchase">
      <view class="menu-icon">💎</view>
      <view class="menu-content">
        <text class="menu-label">深度服务</text>
        <text class="menu-desc">个人/团队深度分析</text>
      </view>
      <text class="menu-arrow">›</text>
    </view>

    <view class="menu-item" bindtap="shareApp">
      <view class="menu-icon">🔗</view>
      <view class="menu-content">
        <text class="menu-label">分享赚佣金</text>
        <text class="menu-desc">好友付费你赚30%</text>
      </view>
      <text class="menu-arrow">›</text>
    </view>

    <view class="menu-item" bindtap="goToFeedback">
      <view class="menu-icon">💬</view>
      <view class="menu-content">
        <text class="menu-label">意见反馈</text>
        <text class="menu-desc">微信: 28533368</text>
      </view>
      <text class="menu-arrow">›</text>
    </view>

    <view class="menu-item" bindtap="goToAbout">
      <view class="menu-icon">ℹ️</view>
      <view class="menu-content">
        <text class="menu-label">关于我们</text>
        <text class="menu-desc">神仙团队AI性格测试</text>
      </view>
      <text class="menu-arrow">›</text>
    </view>
  </view>

  <!-- 最近测试结果 -->
  <view class="results-section" wx:if="{{hasResults}}">
    <text class="section-title">最近测试</text>
    
    <view class="result-item" wx:if="{{mbtiType}}" bindtap="viewMBTI">
      <text class="result-icon">🧠</text>
      <view class="result-info">
        <text class="result-label">MBTI</text>
        <text class="result-value">{{mbtiType}}</text>
      </view>
      <text class="result-arrow">›</text>
    </view>

    <view class="result-item" wx:if="{{discType}}" bindtap="viewDISC">
      <text class="result-icon">💬</text>
      <view class="result-info">
        <text class="result-label">DISC</text>
        <text class="result-value">{{discType}}</text>
      </view>
      <text class="result-arrow">›</text>
    </view>

    <view class="result-item" wx:if="{{pdpType}}" bindtap="viewPDP">
      <text class="result-icon">🐯</text>
      <view class="result-info">
        <text class="result-label">PDP</text>
        <text class="result-value">{{pdpType}}</text>
      </view>
      <text class="result-arrow">›</text>
    </view>
  </view>

  <!-- 退出登录 -->
  <view class="logout-btn" wx:if="{{hasLogin}}" bindtap="logout">
    <text class="logout-text">退出登录</text>
  </view>

  <view class="footer">
    <text class="footer-text">神仙团队AI性格测试 v1.3.0</text>
  </view>
</view>

<!-- 底部导航 -->
<view class="tab-bar">
  <view class="tab-item" bindtap="goToIndex">
    <text class="tab-icon">🏠</text>
    <text class="tab-text">首页</text>
  </view>
  <view class="tab-item tab-center" bindtap="goToCamera">
    <view class="tab-center-btn">
      <text class="tab-center-icon">📸</text>
    </view>
    <text class="tab-text">查看报告</text>
  </view>
  <view class="tab-item active">
    <text class="tab-icon">👤</text>
    <text class="tab-text active-text">我的</text>
  </view>
</view>
