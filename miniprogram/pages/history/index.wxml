<!--pages/history/index.wxml - æµ‹è¯•å†å²è®°å½•-->
<view class="container">
  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:if="{{!hasHistory}}">
    <view class="empty-icon">ğŸ“‹</view>
    <text class="empty-title">æš‚æ— æµ‹è¯•è®°å½•</text>
    <text class="empty-desc">å®Œæˆæµ‹è¯•åï¼Œè®°å½•å°†åœ¨è¿™é‡Œæ˜¾ç¤º</text>
    <view class="empty-btn" bindtap="goToTest">
      <text>å»æµ‹è¯•</text>
    </view>
  </view>

  <!-- æœ‰è®°å½•æ—¶ -->
  <view class="history-list" wx:else>
    <!-- MBTIè®°å½• -->
    <view class="history-section" wx:if="{{mbtiResult}}">
      <view class="section-header">
        <text class="section-title">ğŸ§  MBTIæ€§æ ¼æµ‹è¯•</text>
        <text class="section-time">{{mbtiResult.testTime}}</text>
      </view>
      <view class="history-card" bindtap="viewMBTIResult">
        <view class="card-left">
          <text class="result-type">{{mbtiResult.mbtiType}}</text>
          <text class="result-name">{{mbtiResult.typeName}}</text>
        </view>
        <view class="card-right">
          <text class="confidence">ç½®ä¿¡åº¦ {{mbtiResult.confidence}}%</text>
          <text class="view-detail">æŸ¥çœ‹è¯¦æƒ… â€º</text>
        </view>
      </view>
    </view>

    <!-- DISCè®°å½• -->
    <view class="history-section" wx:if="{{discResult}}">
      <view class="section-header">
        <text class="section-title">ğŸ“Š DISCè¡Œä¸ºæµ‹è¯•</text>
        <text class="section-time">{{discResult.testTime}}</text>
      </view>
      <view class="history-card" bindtap="viewDISCResult">
        <view class="card-left">
          <text class="result-type">{{discResult.dominantType}}å‹</text>
          <text class="result-name">{{discResult.description.title}}</text>
        </view>
        <view class="card-right">
          <view class="disc-bars">
            <view class="disc-bar">
              <text class="bar-label">D</text>
              <view class="bar-track"><view class="bar-fill" style="width: {{discResult.percentages.D}}%"></view></view>
            </view>
            <view class="disc-bar">
              <text class="bar-label">I</text>
              <view class="bar-track"><view class="bar-fill i" style="width: {{discResult.percentages.I}}%"></view></view>
            </view>
            <view class="disc-bar">
              <text class="bar-label">S</text>
              <view class="bar-track"><view class="bar-fill s" style="width: {{discResult.percentages.S}}%"></view></view>
            </view>
            <view class="disc-bar">
              <text class="bar-label">C</text>
              <view class="bar-track"><view class="bar-fill c" style="width: {{discResult.percentages.C}}%"></view></view>
            </view>
          </view>
          <text class="view-detail">æŸ¥çœ‹è¯¦æƒ… â€º</text>
        </view>
      </view>
    </view>

    <!-- PDPè®°å½• -->
    <view class="history-section" wx:if="{{pdpResult}}">
      <view class="section-header">
        <text class="section-title">ğŸ¦ PDPåŠ¨ç‰©æ€§æ ¼</text>
        <text class="section-time">{{pdpResult.testTime}}</text>
      </view>
      <view class="history-card" bindtap="viewPDPResult">
        <view class="card-left">
          <text class="result-emoji">{{pdpResult.description.emoji}}</text>
          <text class="result-name">{{pdpResult.description.type}}</text>
        </view>
        <view class="card-right">
          <text class="result-title">{{pdpResult.description.title}}</text>
          <text class="view-detail">æŸ¥çœ‹è¯¦æƒ… â€º</text>
        </view>
      </view>
    </view>

    <!-- AIåˆ†æè®°å½• -->
    <view class="history-section" wx:if="{{aiResult}}">
      <view class="section-header">
        <text class="section-title">ğŸ‘ï¸ AIäººè„¸åˆ†æ</text>
        <text class="section-time">{{aiResult.testTime}}</text>
      </view>
      <view class="history-card" bindtap="viewAIResult">
        <view class="card-left">
          <text class="result-type">{{aiResult.mbti}}</text>
          <text class="result-name">{{aiResult.title}}</text>
        </view>
        <view class="card-right">
          <view class="ai-badges">
            <text class="ai-badge">{{aiResult.pdpEmoji}} {{aiResult.pdp}}</text>
            <text class="ai-badge">{{aiResult.disc}}å‹</text>
          </view>
          <text class="view-detail">æŸ¥çœ‹è¯¦æƒ… â€º</text>
        </view>
      </view>
    </view>
  </view>
</view>
